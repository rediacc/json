#!/bin/bash

prep() {
    echo "Pulling InfluxDB image..."
    docker pull influxdb:2.7

    echo "Creating data and config directories..."
    mkdir -p ./data
    mkdir -p ./config
    chmod 755 ./data ./config

    return $?
}

up() {
    if [ -f .env ]; then
        source .env
    fi

    echo "Starting InfluxDB server..."
    docker compose up -d

    echo ""
    echo "InfluxDB is starting up..."
    echo "Web UI will be available at: http://localhost:8086"
    echo ""
    echo "To get your admin token after setup:"
    echo "  docker logs ${CONTAINER_NAME:-influxdb-server} 2>&1 | grep 'token'"
    echo ""

    return $?
}

down() {
    echo "Stopping InfluxDB server..."
    docker compose down -v
    return $?
}

