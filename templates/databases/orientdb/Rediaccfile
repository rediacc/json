#!/bin/bash

prep() {
    echo "Pulling OrientDB image..."
    docker pull orientdb:3.2

    echo "Creating data directories..."
    mkdir -p ./databases
    mkdir -p ./backup
    mkdir -p ./config
    chmod 755 ./databases ./backup ./config 2>/dev/null || true

    return 0
}

up() {
    if [ -f .env ]; then
        source .env
    fi

    echo "Starting OrientDB server..."
    docker compose up -d

    echo ""
    echo "OrientDB Studio will be available at:"
    echo "  http://localhost:2480"
    echo ""
    echo "Login with:"
    echo "  Username: root"
    echo "  Password: (from .env file)"
    echo ""

    return $?
}

down() {
    echo "Stopping OrientDB server..."
    docker compose down -v
    return $?
}

